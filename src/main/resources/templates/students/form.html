<!DOCTYPE html>
<html lang="en" xml:lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/base}">
<head>
    <title layout:fragment="title" th:text="${studentId} != null ? 'Edit Student' : 'New Student'">Student</title>
</head>
<body>
<section layout:fragment="content">
    <h1 class="h3 mb-3" th:text="${studentId} != null ? 'Edit Student' : 'New Student'"></h1>

    <div th:if="${successMessage}" class="alert alert-success" th:text="${successMessage}"></div>
    <div th:if="${errorMessage}" class="alert alert-danger" th:text="${errorMessage}"></div>

    <form th:action="${studentId} != null ? @{'/students/' + ${studentId} + '/edit'} : @{/students/new}" method="post" th:object="${studentId} != null ? ${updateRequest} : ${createRequest}">
        <div class="row g-3">
            <div class="col-md-6">
                <label class="form-label" for="nameInput">Name</label>
                <input id="nameInput" type="text" class="form-control" th:field="*{name}" placeholder="First name" required>
                <div class="text-danger small" th:if="${#fields.hasErrors('name')}" th:errors="*{name}"></div>
            </div>
            <div class="col-md-6">
                <label class="form-label" for="lastNameInput">Last Name</label>
                <input id="lastNameInput" type="text" class="form-control" th:field="*{lastName}" placeholder="Surname" required>
                <div class="text-danger small" th:if="${#fields.hasErrors('lastName')}" th:errors="*{lastName}"></div>
            </div>
            <div class="col-md-6">
                <label class="form-label" for="emailInput">Email</label>
                <input id="emailInput" type="email" class="form-control" th:field="*{email}" placeholder="user@example.com" required>
                <div class="text-danger small" th:if="${#fields.hasErrors('email')}" th:errors="*{email}"></div>
            </div>
            <div class="col-md-6">
                <label class="form-label" for="phoneInput">Phone</label>
                <input id="phoneInput" type="text" class="form-control" th:field="*{phoneNumber}" placeholder="+1 555 1234">
                <div class="text-danger small" th:if="${#fields.hasErrors('phoneNumber')}" th:errors="*{phoneNumber}"></div>
            </div>
            <div class="col-md-4" th:if="${studentId} == null">
                <label class="form-label" for="usernameInput">Username (optional)</label>
                <input id="usernameInput" type="text" class="form-control" th:field="*{username}" placeholder="autogenerated if empty">
                <div class="text-danger small" th:if="${#fields.hasErrors('username')}" th:errors="*{username}"></div>
            </div>
            <div class="col-md-4">
                <label class="form-label" for="gradYearInput">Graduation Year</label>
                <input id="gradYearInput" type="number" class="form-control" th:field="*{graduationYear}" min="2024" max="2035" placeholder="2026" required>
                <div class="text-danger small" th:if="${#fields.hasErrors('graduationYear')}" th:errors="*{graduationYear}"></div>
            </div>
        </div>
        <div class="mt-4 d-flex gap-2">
            <button class="btn btn-primary" type="submit" title="Save student"><i class="fa fa-save me-1" aria-hidden="true"></i><span th:text="${studentId} != null ? 'Save' : 'Create'"></span></button>
            <a class="btn btn-secondary" th:href="@{/students}">Cancel</a>
        </div>
    </form>
</section>
</body>
</html>