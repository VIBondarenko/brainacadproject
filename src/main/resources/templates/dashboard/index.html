<!DOCTYPE html>
<html lang="en" 
      xmlns:th="http://www.thymeleaf.org" 
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" 
      layout:decorate="~{layout/base}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
</head>
<body>
    <!-- Breadcrumb -->
    <ol layout:fragment="breadcrumb" class="breadcrumb mb-0">
        <li class="breadcrumb-item">
            <a th:href="@{/}">
                <i class="fas fa-home"></i>Dashboard
            </a>
        </li>
    </ol>
    
    <div layout:fragment="content">
        <!-- Page Header -->
        <div class="row mb-2">
            <div class="col-md-8">
                <div class="col-md-8">
                    <h2><i class="fas fa-graduation-cap me-2"></i>Dashboard</h2>
                    <p class="text-muted"> 
                        Welcome to your dashboard! Here you can get a quick overview of your courses, students, teachers, and recent activities.
                    </p>
                </div>
            </div>
        </div>

        <!-- Modern Metrics Grid -->
        <div class="grid metrics">
            <a th:href="@{/courses}" class="metric">
                <div class="head">
                    <div class="badge">Courses</div>
                </div>
                <div class="value" th:text="${totalCourses}">12</div>
                <div class="sub">Active courses</div>
                <div class="spark"></div>
            </a>
            
            <a th:href="@{/students}" class="metric">
                <div class="head">
                    <div class="badge bg-success">Students</div>
                </div>
                <div class="value" th:text="${totalStudents}">147</div>
                <div class="sub">Enrolled learners</div>
                <div class="spark"></div>
            </a>
            
            <a th:href="@{/trainers}" class="metric">
                <div class="head">
                    <div class="badge bg-warning">Teachers</div>
                </div>
                <div class="value" th:text="${totalTrainers}">8</div>
                <div class="sub">Active teachers</div>
                <div class="spark"></div>
            </a>
            
            <a th:href="@{/tasks}" class="metric">
                <div class="head">
                    <div class="badge bg-info">Tasks</div>
                </div>
                <div class="value">23</div>
                <div class="sub">Pending reviews</div>
                <div class="spark"></div>
            </a>
        </div>

        <!-- Quick Actions -->
        <div class="actions">
            <div class="btns">
                <a th:href="@{/courses/new}" class="btn">
                    <i class="fas fa-plus-circle"></i>New Course
                </a>
                <a th:href="@{/students/new}" class="btn">
                    <i class="fas fa-user-plus"></i>New Student
                </a>
                <a th:href="@{/trainers/new}" class="btn">
                    <i class="fas fa-chalkboard-teacher"></i>New Teacher
                </a>
                <a th:href="@{/tasks/new}" class="btn">
                    <i class="fas fa-clipboard-list"></i>New Task
                </a>
            </div>
        </div>

        <!-- Recent Activity Cards -->
        <div class="cards-row">
            <div class="card">
                <h3>Recent Students</h3>
                <div class="list">
                    <div class="item" th:each="student : ${recentStudents}">
                        <div class="avatar"></div>
                        <div>
                            <div th:text="${student.name} + ' ' + ${student.lastName}">John Doe</div>
                            <div class="id" th:text="'ID: ' + ${student.id}">ID: 123</div>
                        </div>
                        <div class="pill" th:text="${student.courses != null and !student.courses.empty ? student.courses[0].name : 'No course'}">Java</div>
                    </div>
                    <div class="item" th:if="${#lists.isEmpty(recentStudents)}">
                        <div class="avatar"></div>
                        <div>
                            <div>No recent students</div>
                            <div class="id">Add students to see activity</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h3>Active Courses</h3>
                <div class="list">
                    <div class="item" th:each="course : ${activeCourses}">
                        <div class="avatar" style="background: linear-gradient(135deg, #f59e0b, #f97316);"></div>
                        <div>
                            <div th:text="${course.name}">Java Fundamentals</div>
                            <div class="id" th:text="'Students: ' + ${course.students?.size() ?: 0}">Students: 12</div>
                        </div>
                        <div class="pill">Active</div>
                    </div>
                    <div class="item" th:if="${#lists.isEmpty(activeCourses)}">
                        <div class="avatar" style="background: linear-gradient(135deg, #f59e0b, #f97316);"></div>
                        <div>
                            <div>No active courses</div>
                            <div class="id">Create courses to begin</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h3>System Status</h3>
                <div class="list">
                    <div class="item">
                        <div class="avatar" style="background: linear-gradient(135deg, #10b981, #059669);"></div>
                        <div>
                            <div>Database</div>
                            <div class="id">All systems operational</div>
                        </div>
                        <div class="pill" style="background: rgba(16,185,129,.12); color: var(--green);">Online</div>
                    </div>
                    <div class="item">
                        <div class="avatar" style="background: linear-gradient(135deg, #06b6d4, #0891b2);"></div>
                        <div>
                            <div>Server Load</div>
                            <div class="id">CPU: 23% | RAM: 64%</div>
                        </div>
                        <div class="pill" style="background: rgba(6,182,212,.12); color: var(--cyan);">Normal</div>
                    </div>
                    <div class="item">
                        <div class="avatar" style="background: linear-gradient(135deg, #2563eb, #1d4ed8);"></div>
                        <div>
                            <div>Last Backup</div>
                            <div class="id" th:text="${lastDataSave ?: '2 hours ago'}">2 hours ago</div>
                        </div>
                        <div class="pill">Complete</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Recent Activity Table -->
        <div class="card" style="margin-top: 14px;">
            <div class="card-header">
                Recent Activity
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Time</th>
                                <th>Action</th>
                                <th>User</th>
                                <th>Details</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><small class="text-muted">2 min ago</small></td>
                                <td><i class="fas fa-user-plus me-1"></i>Student Added</td>
                                <td>John Doe</td>
                                <td>Enrolled in Java Fundamentals</td>
                                <td><span class="badge bg-success">Success</span></td>
                            </tr>
                            <tr>
                                <td><small class="text-muted">15 min ago</small></td>
                                <td><i class="fas fa-tasks me-1"></i>Task Completed</td>
                                <td>Sarah Wilson</td>
                                <td>Finished Assignment #3</td>
                                <td><span class="badge bg-info">Completed</span></td>
                            </tr>
                            <tr>
                                <td><small class="text-muted">1 hour ago</small></td>
                                <td><i class="fas fa-book-open me-1"></i>Course Created</td>
                                <td>Admin</td>
                                <td>Spring Boot Advanced</td>
                                <td><span class="badge bg-primary">Created</span></td>
                            </tr>
                            <tr>
                                <td><small class="text-muted">3 hours ago</small></td>
                                <td><i class="fas fa-chalkboard-teacher me-1"></i>Trainer Added</td>
                                <td>Michael Chen</td>
                                <td>React Specialist</td>
                                <td><span class="badge bg-warning">Active</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    
    <th:block layout:fragment="scripts">
        <script>
            // Auto-refresh stats every 30 seconds
            setInterval(function() {
                console.log('Refreshing dashboard stats...');
            }, 30000);
        </script>
    </th:block>
</body>
</html>
